



CDNI Working Group                                         F. Fieau, Ed.
Internet-Draft                                                E. Stephan
Intended status: Standards Track                                  Orange
Expires: 15 March 2023                                         S. Mishra
                                                                 Verizon
                                                       11 September 2022


                  CDNI extensions for HTTPS delegation
           draft-ietf-cdni-interfaces-https-delegation-latest

Abstract

   This document defines metadata objects to support delegating the
   delivery of HTTPS traffic between two or more interconnected CDNs.
   Specifically, this document outlines CDNI Metadata interface objects
   for HTTPS delegation based on the interfaces for obtaining delegated
   certificates defined by RFC9115.  Using RFC9115-profiled ACME avoids
   the need to share private cryptographic key material between the
   involved entities, while also allowing the delegating CDN to remain
   in full control of the delegation and revoke it at any time.

About This Document

   This note is to be removed before publishing as an RFC.

   Status information for this document may be found at
   https://datatracker.ietf.org/doc/draft-ietf-cdni-interfaces-https-
   delegation/.

   Discussion of this document takes place on the Content Delivery
   Networks Interconnection Working Group mailing list
   (mailto:cdni@ietf.org), which is archived at
   https://mailarchive.ietf.org/arch/browse/cdni/.  Subscribe at
   https://www.ietf.org/mailman/listinfo/cdni/.

   Source for this draft and an issue tracker can be found at
   https://github.com/TODO.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at https://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on 15 March 2023.

Copyright Notice

   Copyright (c) 2022 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents (https://trustee.ietf.org/
   license-info) in effect on the date of publication of this document.
   Please review these documents carefully, as they describe your rights
   and restrictions with respect to this document.  Code Components
   extracted from this document must include Revised BSD License text as
   described in Section 4.e of the Trust Legal Provisions and are
   provided without warranty as described in the Revised BSD License.

Table of Contents

   1.   Introduction
     1.1.  Terminology
   2.  Advertising Delegation Metadata for CDNI through FCI
   3.   ACME Delegation Metadata for CDNI
   4.   IANA Considerations
     4.1.  CDNI MI AcmeStarDelegationMethod Payload Type
   5.  Security considerations
   6.  References
     6.1.  Normative References
     6.2.  Informative References
   Acknowledgments
   Authors' Addresses

1.   Introduction

   Content delivery over HTTPS using one or more CDNs along the path
   requires credential management specifically when DNS-based
   redirection is used.  For example, an uCDN is delegating its
   credentials to a dCDN for content delivery.  This specifically
   applies when an entity delegates delivery of encrypted content to
   another trusted entity.

   [RFC9115] defines a delegation method where the upstream Content
   Delivery Network (uCDN), the holder of the domain, generates on-
   demand an X.509 certificate for the downstream CDN (dCDN).  For
   further details, please refer to Section 1 of [RFC9115] and
   Section 5.1.2.1 of [RFC9115].

   This document defines CDNI Metadata to make use of HTTPS delegation
   between an uCDN and a dCDN based on the mechanism specified in
   [RFC9115].  Furthermore, it includes an addition of a delegation
   methods to the IANA registry.

   Section 1.1 defines terminology used in this document.  Section 2
   presents delegation metadata for the FCI interface.  Section 3
   addresses the metadata for handling HTTPS delegation with the
   Metadata Interface.  Section 4 addresses IANA registry for delegation
   methods.  Section 5 covers the security considerations.

1.1.  Terminology

   This document uses terminology from CDNI framework documents such as:
   CDNI framework document [RFC7336], CDNI requirements [RFC7337] and
   CDNI interface specifications documents: CDNI Metadata interface
   [RFC8006] and CDNI Footprint and capabilities [RFC8008].  It also
   uses terminology from Section 1.1 of [RFC8739].

2.  Advertising Delegation Metadata for CDNI through FCI

   The Footprint and Capabilities interface as defined in [RFC8008],
   allows a dCDN to send a FCI capability type object to a uCDN.

   The FCI.Metadata object shall allow a dCDN to advertise the
   capabilities regarding the supported delegation methods and their
   configuration.

   The following is an example of the supported delegated methods
   capability object for a CDN supporting STAR delegation method.

   {
     "capabilities": [
       {
         "capability-type": "FCI.Metadata",
         "capability-value": {
           "metadata": [
             "AcmeStarDelegationMethod",
             "... Other supported delegation methods ..."
           ]
         },
         "footprints": [
           "Footprint objects"
         ]
       }
     ]
   }

3.   ACME Delegation Metadata for CDNI

   This section defines the AcmeStarDelegationMethod object which
   describes metadata related to the use of ACME/STAR API presented in
   [RFC9115].

   This allows bootstrapping ACME delegation method between a uCDN and a
   delegate dCDN.

   As expressed in [RFC9115], when an origin has set a delegation to a
   specific domain (i.e., dCDN), the dCDN should present to the end-user
   client a short-term certificate bound to the master certificate.

                                                       .------------.
                               video.cp.example ?     | .-----.      |
                    .---------------------------------->|     |      |
                   |                  (a)             | | DNS |  CP  |
                   |    .-------------------------------+     |      |
                   |   |   CNAME video.ucdn.example   | '-----'      |
                   |   |                               '------------'
                   |   |
                   |   |
       .-----------|---v--.                            .------------.
      |    .-----.-+-----. |   video.ucdn.example ?   | .-----.      |
      |    |     |       +----------------------------->|     |      |
      | UA | TLS |  DNS  | |          (b)             | | DNS | uCDN |
      |    |     |       |<-----------------------------+     |      |
      |    '--+--'-----+-' | CNAME video.dcdn.example | '-----'      |
       '------|----^---|--'                            '------------'
              |    |   |
              |    |   |
              |    |   |                               .------------.
              |    |   |      video.dcdn.example ?    | .-----.      |
              |    |    '------------------------------>|     |      |
              |    |                  (c)             | | DNS |      |
              |     '-----------------------------------+     |      |
              |                   A 192.0.2.1         | +-----+ dCDN |
              |                                       | |     |      |
               '--------------------------------------->| TLS |      |
                           SNI: video.cp.example      | |     |      |
                                                      | '-----'      |
                                                       '------------'

   TO BE REMOVED:

dCDN                  uCDN             Content Provider           CA
 |              ACME/STAR proxy        ACME/STAR client    ACME/STAR srv
 |                     |                     |                     |
 | 1. GET Metadata incl. Delegation Method object with CSR template|
 +-------------------->|                     |                     |
 | 200 OK + Metadata incl. CSR template [CDNI]                     |
 |<--------------------+                     |                     |
 | 2. Request delegation: video.dcdn.example + dCDN public key     |
 +-------------------->|                     |                     |
 |                     | 3. Request STAR Cert + dCDN public key    |
 |                     +-------------------->| 4. Request STAR cert|
 |                     |                     |    + Pubkey         |
 |                     |                     |-------------------->|
 |                     |                     | 5. STAR certificate |
 |                     | 6. STAR certificate |<--------------------|
 | 7. STAR certificate |<--------------------+                     |
 +<--------------------|                     |                     |
 |                     |                     |                     |
 | 8. Retrieve STAR certificate (credential-location-uri)          |
 +---------------------------------------------------------------->|
 |                     |                     |         9. renew +--|
 |                     |                     |            cert  |  |
 | 10. Star certificate                      |                  +->|
 |<----------------------------------------------------------------+
 |  ...                |                     |                     |

   Figure 1: Example call-flow of STAR delegation in CDNI showing 2
                         levels of delegation

   *  Property: acme-delegations

   *  Description: an array of delegation objects associated with the
      dCDN account on the uCDN ACME server (see Section 2.3.1 of
      [RFC9115] for the details).

   *  Type: Objects

   *  Mandatory-to-Specify: Yes

   Below shows both HostMatch and its Metadata related to a host, for
   example, here is a HostMatch object referencing "video.example.com"
   and a list of 2 acme-delegation objects.

   Following the example above, the metadata is modeled for
   ACMEStarDelegationMethod as follows:

   {
     "generic-metadata-type": "MI.AcmeStarDelegationMethod",
     "generic-metadata-value": {
       "acme-delegations": [
         "https://acme.ucdn.example/acme/delegation/ogfr8EcolOT",
         "https://acme.ucdn.example/acme/delegation/wSi5Lbb61E4"
       ]
     }
   }

4.   IANA Considerations

   This document requests the registration of the following entries
   under the "CDNI Payload Types" registry hosted by IANA regarding
   "CDNI delegation":

              +=============================+===============+
              | Payload Type                | Specification |
              +=============================+===============+
              | MI.AcmeStarDelegationMethod | RFCthis       |
              +-----------------------------+---------------+

                                  Table 1


   // RFC Editor: please replace RFCthis with the RFC number of this RFC
   // and remove this note.

4.1.  CDNI MI AcmeStarDelegationMethod Payload Type

   Purpose:  The purpose of this Payload Type is to distinguish
      AcmeStarDelegationMethod MI objects (and any associated capability
      advertisement)

   Interface:  MI

   Encoding:  See Section 3

5.  Security considerations

   Delegation metadata proposed here do not alter nor change Security
   Considerations as outlined in the following RFCs: An Automatic
   Certificate Management Environment (ACME) Profile for Generating
   Delegated Certificates [RFC9115]; the CDNI Metadata [RFC8006] and
   CDNI Footprint and Capabilities [RFC8008].

   The delegation objects properties such as the list of delegation
   objects mentioned in Section 3are critical.  They should be protected
   by the proper/mandated encryption and authentication.  Please refer
   to Sections 7.1, 7.2 and 7.4 of [RFC9115].

6.  References

6.1.  Normative References

   [RFC8006]  Niven-Jenkins, B., Murray, R., Caulfield, M., and K. Ma,
              "Content Delivery Network Interconnection (CDNI)
              Metadata", RFC 8006, DOI 10.17487/RFC8006, December 2016,
              <https://www.rfc-editor.org/rfc/rfc8006>.

   [RFC8008]  Seedorf, J., Peterson, J., Previdi, S., van Brandenburg,
              R., and K. Ma, "Content Delivery Network Interconnection
              (CDNI) Request Routing: Footprint and Capabilities
              Semantics", RFC 8008, DOI 10.17487/RFC8008, December 2016,
              <https://www.rfc-editor.org/rfc/rfc8008>.

   [RFC8739]  Sheffer, Y., Lopez, D., Gonzalez de Dios, O., Pastor
              Perales, A., and T. Fossati, "Support for Short-Term,
              Automatically Renewed (STAR) Certificates in the Automated
              Certificate Management Environment (ACME)", RFC 8739,
              DOI 10.17487/RFC8739, March 2020,
              <https://www.rfc-editor.org/rfc/rfc8739>.

   [RFC9115]  Sheffer, Y., López, D., Pastor Perales, A., and T.
              Fossati, "An Automatic Certificate Management Environment
              (ACME) Profile for Generating Delegated Certificates",
              RFC 9115, DOI 10.17487/RFC9115, September 2021,
              <https://www.rfc-editor.org/rfc/rfc9115>.

6.2.  Informative References

   [RFC7336]  Peterson, L., Davie, B., and R. van Brandenburg, Ed.,
              "Framework for Content Distribution Network
              Interconnection (CDNI)", RFC 7336, DOI 10.17487/RFC7336,
              August 2014, <https://www.rfc-editor.org/rfc/rfc7336>.

   [RFC7337]  Leung, K., Ed. and Y. Lee, Ed., "Content Distribution
              Network Interconnection (CDNI) Requirements", RFC 7337,
              DOI 10.17487/RFC7337, August 2014,
              <https://www.rfc-editor.org/rfc/rfc7337>.

Acknowledgments

   TODO

Authors' Addresses

   Frédéric Fieau (editor)
   Orange
   40-48, avenue de la Republique
   92320 Chatillon
   France
   Email: frederic.fieau@orange.com


   Emile Stephan
   Orange
   2, avenue Pierre Marzin
   22300 Lannion
   France
   Email: emile.stephan@orange.com


   Sanjay Mishra
   Verizon
   13100 Columbia Pike
   Silver Spring,  MD 20904
   United States of America
   Email: sanjay.mishra@verizon.com
